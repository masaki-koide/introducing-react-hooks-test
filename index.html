<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><meta name="theme-color" content="#3498db"><meta name="viewport" content="width=device-width,initial-scale=1"><title>slide</title><meta property="og:title" content="slide"><meta property="og:type" content="article"><link href="vendor.6.9dcfec5109db0f827695.css" rel="stylesheet"><link href="main.3.a495ed5bf982d6912c40.css" rel="stylesheet"></head><body><div id="root"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="btn-sidebar" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg><article id="webslides"><section class="aligncenter title"><h1>React Hooksã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã¿ã‚ˆã†</h1><br><p>Meguro.es #22<br>08/08</p></section><section class="aligncenter"><h1>è‡ªå·±ç´¹ä»‹</h1><div class="card-50"><div class="flex-content"><img src="https://pbs.twimg.com/profile_images/979597254188126208/Kw_5K41V_400x400.jpg"></div><div class="flex-content"><ul class="description"><li>åå‰: markey, <a href="https://twitter.com/markey_koichan">markey_koichan(Twitter)</a></li><li>è·æ¥­: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢</li><li>ã‚¹ã‚­ãƒ«: React/Vue/TypeScript</li><li>è¶£å‘³: æ—¥æœ¬èªãƒ©ãƒƒãƒ—ã€MCãƒãƒˆãƒ«é‘‘è³</li></ul></div></div><p>äººç”ŸåˆLTã€ãŠæ‰‹æŸ”ã‚‰ã‹ã«ğŸ™</p></section><section class="aligncenter"><h1>ãƒ†ã‚¹ãƒˆã€æ›¸ã„ã¦ã¾ã™ã‹ï¼Ÿ</h1></section><section class="aligncenter"><h1>React Hooksã®ãƒ†ã‚¹ãƒˆã€æ›¸ã„ã¦ã¾ã™ã‹ï¼Ÿ</h1></section><section class="aligncenter"><h1>React Hooksèª•ç”Ÿå¾Œã®ä¸–ç•Œ</h1><ul class="flexblock activity"><li>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆâ†’Function Component</li><li>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯â†’Custom Hook</li></ul></section><section class="aligncenter"><h1>ã“ã‚“ãªã„ã„ã“ã¨ãŒ</h1><br><ul><li>UIã¨ãƒ­ã‚¸ãƒƒã‚¯ãŒåˆ†é›¢ã•ã‚Œã€ãƒ†ã‚¹ã‚¿ãƒ–ãƒ«ãªã‚³ãƒ¼ãƒ‰ã«</li><li>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’Custom Hookã«é›†ç´„ã™ã‚‹(APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»åŠ å·¥ã€çŠ¶æ…‹ã€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼)</li><li>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é–‹ç™ºã¯å—ã‘å–ã‚‹Propsã®å®šç¾©ã¨ã€ãã‚Œã‚‰ã‚’å…ƒã«ã—ãŸè¡¨ç¤ºã®ã¿</li><li>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–‹ç™ºè€…ã¯ãƒ­ã‚¸ãƒƒã‚¯éƒ¨åˆ†ã‚„APIã®ä»•æ§˜ãªã©ã‚’ä¸€åˆ‡çŸ¥ã‚‹å¿…è¦ãŒãªã„</li><li>è¤‡æ•°ã®é–‹ç™ºè€…ãŒåŒä¸€ãƒšãƒ¼ã‚¸ã®UIã¨ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¸¦è¡Œé–‹ç™ºã™ã‚‹ã“ã¨ãŒå¯èƒ½</li></ul></section><section class="aligncenter"><h1>ä»Šã“ãã€ãƒ†ã‚¹ãƒˆã‚’ã‚„ã‚‹ãƒãƒ£ãƒ³ã‚¹ğŸ‰</h1></section><section class="aligncenter"><h1>ãã‚Œãã‚Œã®ãƒ†ã‚¹ãƒˆ</h1><ul class="flexblock activity"><li>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆâ†’Storybook + reg-suit</li><li>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯â†’@testing-library/react-hooks</li></ul></section><section class="aligncenter"><h1>ä»Šæ—¥è©±ã™ã®ã¯ã“ã“</h1><ul class="flexblock activity"><li>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆâ†’Storybook + reg-suit</li><li class="bg-primary">ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯â†’@testing-library/react-hooks</li></ul></section><section class="aligncenter"><h1>@testing-library/react-hooks</h1><br><ul><li><a href="https://react-hooks-testing-library.com/">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li><li>React Hooksã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</li><li>hookã‚’ã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã®ã‚ˆã†ã«å®Ÿè¡Œã§ã(ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä¸è¦)ã€<br>hookã®æ›´æ–°ã‚‚å®¹æ˜“</li><li><a href="https://github.com/testing-library/react-hooks-testing-library/blob/master/src/index.js">ãƒ¡ã‚¤ãƒ³ã®ãƒ•ã‚¡ã‚¤ãƒ«</a>ã¯ã‚ãšã‹93è¡Œ</li></ul></section><section class="aligncenter"><h1>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è¿½åŠ </h1><br><pre><code class="language-shell">yarn add --dev @testing-library/react-hooks

# ã‚‚ã—ãã¯
npm install --save-dev @testing-library/react-hooks
</code></pre></section><section class="aligncenter"><p>@testing-library/react-hooksã‚’ä½¿ã£ãŸã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ã‚¹ãƒˆ</p><br><pre><code class="language-javascript">import { useState, useCallback } from &#x27;React&#x27;

export default function useCounter() {
  const [count, setCount] = useState(0)
  const increment = useCallback(() =&gt; setCount((x) =&gt; x + 1), [])
  return { count, increment }
}
</code></pre><pre><code class="language-javascript">import { renderHook } from &#x27;@testing-library/react-hooks&#x27;
import useCounter from &#x27;.&#x27;

test(&#x27;should use counter&#x27;, () =&gt; {
  // hookã‚’å®Ÿè¡Œ
  const { result } = renderHook(() =&gt; useCounter())

  // resut.currentã‹ã‚‰hookã®è¿”ã‚Šå€¤ã‚’å–å¾—
  expect(result.current.count).toBe(0)
  expect(typeof result.current.increment).toBe(&#x27;function&#x27;)
})
</code></pre></section><section class="aligncenter"><p>ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã®hookã®å‹•ä½œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¦ã€<br>å€¤ã‚’æ›´æ–°ã™ã‚‹ã«ã¯ï¼ŸğŸ¤”</p><br><pre><code class="language-javascript">test(&#x27;should increment counter&#x27;, () =&gt; {
  const { result } = renderHook(() =&gt; useCounter())

  expect(result.current.count).toBe(0)

  // actã§ãƒ©ãƒƒãƒ—ã™ã‚‹
  act(() =&gt; {
    result.current.increment()
  })

  expect(result.current.count).toBe(1)
})
</code></pre></section><section class="aligncenter"><p>Contextã‹ã‚‰å€¤ã‚’å–å¾—ã™ã‚‹ã¨ãã¯ã©ã†ã™ã‚‹ï¼ŸğŸ¤”<br>(Redux, Apollo Client, ...)</p><br><pre><code class="language-javascript">const CounterStepContext = React.createContext(1)

export const CounterStepProvider = ({ step, children }) =&gt; (
  &lt;CounterStepContext.Provider value={step}&gt;{children}&lt;/CounterStepContext.Provider&gt;
)

export function useCounter() {
  const [count, setCount] = useState(0)
  // incrementã™ã‚‹å€¤ã¯Contextã‹ã‚‰å–å¾—
  const step = useContext(CounterStepContext)
  const increment = useCallback(() =&gt; setCount((x) =&gt; x + step), [step])
  return { count, increment }
}
</code></pre></section><section class="aligncenter"><pre><code class="language-javascript">import { useCounter, CounterStepProvider } from &#x27;.&#x27;

test(&#x27;should use custom step when incrementing&#x27;, () =&gt; {
  const wrapper = ({ children }) =&gt; (
    &lt;CounterStepProvider step={2}&gt;{children}&lt;/CounterStepProvider&gt;
  )
  // renderHookã®ç¬¬2å¼•æ•°ã«wrapperã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š
  const { result } = renderHook(() =&gt; useCounter(), { wrapper })

  expect(result.current.count).toBe(0)

  act(() =&gt; {
    result.current.increment()
  })

  expect(result.current.count).toBe(2)
})
</code></pre></section><section class="aligncenter"><p>éåŒæœŸãªé–¢æ•°ã®å®Ÿè¡Œã¯ã©ã†ã™ã‚‹ï¼ŸğŸ¤”</p><br><pre><code class="language-javascript">export default function useCounter() {
  const [count, setCount] = useState(0)
  const increment = useCallback(() =&gt; setCount((x) =&gt; x + 1), [])
  // 0.1ç§’å¾Œã«éåŒæœŸã«incrementã™ã‚‹
  const incrementAsync = useCallback(() =&gt; setTimeout(increment, 100), [increment])
  return { count, increment, incrementAsync }
}
</code></pre></section><section class="aligncenter"><pre><code class="language-javascript">test(&#x27;should increment counter after delay&#x27;, async () =&gt; {
  const { result, waitForNextUpdate } = renderHook(() =&gt; useCounter())

  result.current.incrementAsync()

  // å®Ÿè¡Œç›´å¾Œã¯ã¾ã incrementã•ã‚Œã¦ã„ãªã„
  expect(result.current.count).toBe(0)

  // PromiseãŒresolveã•ã‚Œã‚‹ã¾ã§å¾…ã¤
  await waitForNextUpdate()

  expect(result.current.count).toBe(1)
})
</code></pre></section><section class="aligncenter"><h1>@testing-library/react-hooksã§<br>å¿«é©ãªãƒ†ã‚¹ãƒˆãƒ©ã‚¤ãƒ•ã‚’ğŸ‘</h1></section><section class="aligncenter"><h1>ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h1><br><p>(å‰¯æ¥­å‹Ÿé›†ä¸­...Reactã¨TypeScriptãƒãƒ§ãƒƒãƒˆã‚«ã‚±ãƒã‚¹...)</p></section></article></div><script type="text/javascript" src="runtime.2a727deff67ab69ed6b8.bundle.js"></script><script type="text/javascript" src="vendor.6.9dcfec5109db0f827695.bundle.js"></script><script type="text/javascript" src="main.3.a495ed5bf982d6912c40.bundle.js"></script></body></html>